<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Notes on Thermodynamics &mdash; MAESTROeX  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css?v=10589de1" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "macros": {"rhozero": "{\\rho_0}", "pizero": "{\\pi_0}", "pizeroone": "{\\pi_0^{(1)}}", "pizerotwo": "{\\pi_0^{(2)}}", "gammabar": "{\\overline{\\Gamma}_1}", "ptl": "{\\partial}", "eb": "{{\\bf e}}", "fb": "{{\\bf f}}", "ib": "{{\\bf i}}", "Ub": "{{\\bf U}}", "Vb": "{{\\bf V}}", "xb": "{{\\bf x}}", "ut": "{{\\tilde{u}}}", "vt": "{{\\tilde{v}}}", "wt": "{{\\tilde{w}}}", "Ubt": "{\\widetilde{\\Ub}}", "edge": "{{\\rm EDGE}}", "mac": "{{\\rm MAC}}", "trans": "{{\\rm TRANS}}", "nablab": "{\\mathbf{\\nabla}}", "cdotb": "{\\mathbf{\\cdot}}", "half": "{\\frac{1}{2}}", "myhalf": "{\\frac{1}{2}}", "nph": "{{n + \\myhalf}}", "nmh": "{{n - \\myhalf}}", "Hext": "{{H_{\\rm ext}}}", "Hnuc": "{{H_{\\rm nuc}}}", "kth": "{k_{\\rm th}}", "init": "{\\rm init}", "model": "{\\rm model}", "raw": "{\\rm raw}", "pred": "{{\\rm pred}}", "Sbar": "{\\overline{S}}", "inp": "{\\mathrm{in}}", "initp": "{\\mathrm{init}}", "outp": "{\\mathrm{out}}", "uadv": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvone": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV},\\star}}", "uadvonedag": "{\\Ubt^{\\mathrm{ADV},\\dagger,\\star}}", "uadvtwo": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvtwodag": "{\\Ubt^{\\mathrm{ADV},\\dagger}}", "uadvsdcstar": "{\\mathbf{U}^{\\mathrm{ADV},\\star}}", "uadvsdcpred": "{\\mathbf{U}^{\\mathrm{ADV},\\mathrm{pred}}}", "uadvsdc": "{\\mathbf{U}^{\\mathrm{ADV}}}", "dt": "{\\Delta t}", "dr": "{\\Delta r}", "etarho": "{\\eta_{\\rho}}", "etarhoec": "{\\etarho^{\\rm ec}}", "etarhocc": "{\\etarho^{\\rm cc}}", "etarhoflux": "{\\etarho^{\\rm flux}}", "divetarho": "{\\nabla\\cdot(\\etarho\\eb_r)}", "ow": "{\\overline{w}_0}", "dw": "{\\delta w_0}", "thalf": "{\\frac{3}{2}}", "rhop": "{{\\rho^{\\prime}}}", "omegadot": "{\\dot{\\omega}}", "er": "{\\mathbf{e}_r}", "ex": "{\\mathbf{e}_x}", "ey": "{\\mathbf{e}_y}", "ez": "{\\mathbf{e}_z}", "Omegab": "{{\\bf \\Omega}}", "rb": "{{\\bf r}}", "boxtype": "{{\\tt box\\/}}", "fab": "{{\\tt fab\\/}}", "multifab": "{{\\tt multifab\\/}}", "boxarray": "{{\\tt boxarray\\/}}", "mlboxarray": "{{\\tt ml\\_boxarray\\/}}", "layout": "{{\\tt layout\\/}}", "mllayout": "{{\\tt ml\\_layout\\/}}", "bctower": "{{\\tt bc\\_tower\\/}}", "bclevel": "{{\\tt bc\\_level\\/}}", "mgtower": "{{\\tt mg\\_tower\\/}}", "bndryreg": "{{\\tt bndry\\_reg\\/}}", "runparam": ["{\\index{Runtime parameters!{\\tt #1}}{\\tt #1}}", 1], "runparamidx": ["{\\index{Runtime parameters!{\\tt #1}}}", 1], "code": ["{\\index{Code reference!{\\tt #1}}{\\tt #1}}", 1], "codeidx": ["{\\index{Code reference!{\\tt #1}}}", 1], "otherindex": ["{\\index{#1!#2}}", 2], "fdamp": "{{f_\\mathrm{damp}}}"}}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Notes on \(\beta_0\)" href="beta0.html" />
    <link rel="prev" title="Modifications for a \(1/r^2\) Plane-Parallel Basestate" href="planar_invsq_basestate.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >


          
          
          <a href="index.html" class="icon icon-home">
            MAESTROeX
              <img src="_static/maestroex_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
    <div class="branch">
        Branch: <a href="./thermo_notes.html">main</a> | <a href="./dev/thermo_notes.html">development</a>
    </div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">MAESTROeX basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to MAESTROeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="flowchart.html">Governing Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="flowchart.html#numerical-methodology">Numerical Methodology</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using MAESTROeX</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="addproblem.html">Adding A New Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="problems.html">Problem Setups</a></li>
<li class="toctree-l1"><a class="reference internal" href="unit_tests.html">Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="param_intro.html">Runtime Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="initial_models.html">Initial Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu.html">GPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="base_state.html">Base State</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="makefiles.html">MAESTROeX Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="managingjobs.html">Managing Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">MAESTROeX technical details</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="lo_density.html">Low Density Cutoffs</a></li>
<li class="toctree-l1"><a class="reference internal" href="volume_discrepancy.html">Volume Discrepancy Factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="eos_notes.html">Equation of State Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="networks.html">Reaction Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html">The Mixing Term, <span class="math notranslate nohighlight">\(\etarho\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html#eta-flow-chart"><span class="math notranslate nohighlight">\(\eta\)</span> Flow Chart</a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html#computing-etarhoec-and-etarhocc">Computing <span class="math notranslate nohighlight">\(\etarhoec\)</span> and <span class="math notranslate nohighlight">\(\etarhocc\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html#using-etarhoec">Using <span class="math notranslate nohighlight">\(\etarhoec\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html#using-etarhocc">Using <span class="math notranslate nohighlight">\(\etarhocc\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="pert.html">Interface State Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="Godunov.html">Godunov Interface States</a></li>
<li class="toctree-l1"><a class="reference internal" href="mg.html">Multigrid</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotation.html">Rotation in MAESTROeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="spherical_basestate.html">Modifications for a Spherical Self-Gravitating Star</a></li>
<li class="toctree-l1"><a class="reference internal" href="planar_invsq_basestate.html">Modifications for a <span class="math notranslate nohighlight">\(1/r^2\)</span> Plane-Parallel Basestate</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Notes on Thermodynamics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#derivatives-with-respect-to-composition">Derivatives With Respect to Composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#convective-stability-criterion">Convective stability criterion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adiabatic-excess">Adiabatic Excess</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beta0.html">Notes on <span class="math notranslate nohighlight">\(\beta_0\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="enthalpy.html">Notes on Enthalpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="regtest.html">Regression Testing and Continuous Integration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="filelist.html">File list</a></li>
<li class="toctree-l1"><a class="reference internal" href="classlist.html">Class list</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MAESTROeX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Notes on Thermodynamics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/thermo_notes.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="notes-on-thermodynamics">
<h1>Notes on Thermodynamics<a class="headerlink" href="#notes-on-thermodynamics" title="Link to this heading"></a></h1>
<section id="derivatives-with-respect-to-composition">
<h2>Derivatives With Respect to Composition<a class="headerlink" href="#derivatives-with-respect-to-composition" title="Link to this heading"></a></h2>
<p>In the following we assume that the molar mass of species <span class="math notranslate nohighlight">\(i\)</span> is given by its
atomic mass number, <span class="math notranslate nohighlight">\(A_i = N_i + Z_i\)</span> where <span class="math notranslate nohighlight">\(N_i\)</span> is the number of neutrons
and <span class="math notranslate nohighlight">\(Z_i\)</span> is the number of protons in the isotope. This
is a slight approximation that ignores the mass difference between protons
and neutrons as well as some minor binding energy terms.</p>
<p>The number density [cm:math:<cite>^-{3}</cite>] of isotope <span class="math notranslate nohighlight">\(i\)</span> is can be formed from the mass
density and the molar mass of that isotope as follows:</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-0">
<span class="eqno">(324)<a class="headerlink" href="#equation-thermo-notes-0" title="Link to this equation"></a></span>\[\label{eq:number density}
  n_i = \frac{\rho_i N_\text{A}}{A_i},\]</div>
<p>where <span class="math notranslate nohighlight">\(N_\text{A}\)</span> is Avogadro’s number [# / mole]. The molar abundance,
<span class="math notranslate nohighlight">\(Y_i\)</span>, is a measure of the number of moles of species <span class="math notranslate nohighlight">\(i\)</span> per gram in the
system:</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-1">
<span class="eqno">(325)<a class="headerlink" href="#equation-thermo-notes-1" title="Link to this equation"></a></span>\[\label{eq:molar abundance}
  Y_i = \frac{n_i}{\rho N_\text{A}} = \frac{\rho_i}{\rho}\frac{1}{A_i}
  \equiv \frac{X_i}{A_i}\]</div>
<p>where we have defined the mass fraction, <span class="math notranslate nohighlight">\(X_i = \frac{\rho_i}{\rho}\)</span>. Note</p>
<div class="math notranslate nohighlight" id="equation-eq-mass-fraction-sums-to-1">
<span class="eqno">(326)<a class="headerlink" href="#equation-eq-mass-fraction-sums-to-1" title="Link to this equation"></a></span>\[\sum_i X_i = 1.\]</div>
<p>We write the average molar mass and average proton number as:</p>
<div class="math notranslate nohighlight" id="equation-eq-abar">
<span class="eqno">(327)<a class="headerlink" href="#equation-eq-abar" title="Link to this equation"></a></span>\[\bar{A} = \frac{\sum_i A_i n_i}{\sum_i n_i} = \left(\sum_i X_i\right)
  \left(\sum_i \frac{X_i}{A_i}\right)^{-1}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-zbar">
<span class="eqno">(328)<a class="headerlink" href="#equation-eq-zbar" title="Link to this equation"></a></span>\[\bar{Z} = \frac{\sum_i Z_i n_i}{\sum_i n_i} = \left(\sum_i Z_i
  \frac{X_i}{A_i}\right)\left(\sum_i \frac{X_i}{A_i}\right)^{-1}.\]</div>
<p>Our algorithm requires terms involving the derivative thermodynamic variables
(<span class="math notranslate nohighlight">\(p\)</span> or <span class="math notranslate nohighlight">\(e\)</span>, e.g.) with respect to composition. Our EOS does not return such
derivatives but instead returns derivatives of these variables with respect
to <span class="math notranslate nohighlight">\(\bar{A}\)</span> and <span class="math notranslate nohighlight">\(\bar{Z}\)</span>. Using the chain rule, we have</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-2">
<span class="eqno">(329)<a class="headerlink" href="#equation-thermo-notes-2" title="Link to this equation"></a></span>\[\label{eq:p_xk}
  \frac{\ptl p}{\ptl X_k} = p_{X_k} =
  \frac{\ptl p}{\ptl \bar{A}}\frac{\ptl \bar{A}}{\ptl X_k} +
  \frac{\ptl p}{\ptl \bar{Z}}\frac{\ptl \bar{Z}}{\ptl X_k}.\]</div>
<p>From <a class="reference internal" href="#equation-eq-abar">Eq.327</a> and <a class="reference internal" href="#equation-eq-zbar">Eq.328</a> we have</p>
<div class="math notranslate nohighlight" id="equation-eq-abar-x-k">
<span class="eqno">(330)<a class="headerlink" href="#equation-eq-abar-x-k" title="Link to this equation"></a></span>\[\frac{\ptl \bar{A}}{\ptl X_k} = \left(\sum_i \frac{X_i}{A_i}\right)^{-1}
  - \frac{\bar{A}^2}{A_k} = -\frac{\bar{A}}{A_k}\left(\bar{A} - A_k\right)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-zbar-x-k">
<span class="eqno">(331)<a class="headerlink" href="#equation-eq-zbar-x-k" title="Link to this equation"></a></span>\[\frac{\ptl \bar{Z}}{\ptl X_k} =
  \left(\frac{Z_k}{A_k}\right)\left(\sum_i \frac{X_i}{A_i}\right)^{-1}
  - \frac{\bar{Z}}{A_k}\left(\sum_i \frac{X_i}{A_i}\right)^{-1} =
  -\frac{\bar{A}}{A_k}\left(\bar{Z} - Z_k\right),\]</div>
<p>where after differentiation we have used <a class="reference internal" href="#equation-eq-mass-fraction-sums-to-1">Eq.326</a>
to write</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-3">
<span class="eqno">(332)<a class="headerlink" href="#equation-thermo-notes-3" title="Link to this equation"></a></span>\[\left(\sum_i \frac{X_i}{A_i}\right)^{-1} = \bar{A}.\]</div>
<p>We therefore have</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-4">
<span class="eqno">(333)<a class="headerlink" href="#equation-thermo-notes-4" title="Link to this equation"></a></span>\[\label{eq:p_Xk_full}
  p_{X_k} = -\frac{\bar{A}}{A_k}\left(\bar{A} - A_k\right)
  \frac{\ptl p}{\ptl\bar{A}} - \frac{\bar{A}}{A_k}\left(\bar{Z} - Z_k\right)
  \frac{\ptl p}{\ptl\bar{Z}}.\]</div>
<p>Before it was brought to our attention by Frank Timmes, we were missing the
second term in <a class="reference internal" href="#equation-eq-abar-x-k">Eq.330</a>. The only place where such terms
appear in our algorithm is in a sum over all species, such as:</p>
<div class="math notranslate nohighlight" id="equation-eq-sum-over-species">
<span class="eqno">(334)<a class="headerlink" href="#equation-eq-sum-over-species" title="Link to this equation"></a></span>\[\sum_i p_{X_i}\dot{\omega}_i =
  -\bar{A}^2\frac{\ptl p}{\ptl\bar{A}}\sum_i \frac{\dot{\omega}_i}{A_i}
  +\bar{A}\frac{\ptl p}{\ptl\bar{A}}\sum_i \dot{\omega}_i
  -\bar{A}\bar{Z}\frac{\ptl p}{\ptl\bar{Z}}\sum_i \frac{\dot{\omega}_i}{A_i}
  +\bar{A}\frac{\ptl p}{\ptl \bar{Z}}\sum_i\frac{Z_i}{A_i}\dot{\omega}_i.\]</div>
<p>The second term in <a class="reference internal" href="#equation-eq-sum-over-species">Eq.334</a> is identically zero because</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-5">
<span class="eqno">(335)<a class="headerlink" href="#equation-thermo-notes-5" title="Link to this equation"></a></span>\[\sum_k \dot{\omega}_k \equiv 0.\]</div>
<p>This second term arises from what was added to <a class="reference internal" href="#equation-eq-abar-x-k">Eq.330</a> by
Frank’s correction. Therefore, although important for individual derivatives
with respect to composition, this correction term has no effect on our
solution.</p>
</section>
<section id="convective-stability-criterion">
<h2>Convective stability criterion<a class="headerlink" href="#convective-stability-criterion" title="Link to this heading"></a></h2>
<p>Here we look at the criterion for convective stability in the case of
non-uniform chemical composition. This section follows Cox &amp; Giuli
<a href="#id1"><span class="problematic" id="id2">:raw-latex:`\cite{cg-ed2}`</span></a> closely (see chapter 13).</p>
<p>Consider a fluid parcel that gets displaced upwards (against gravity) from
a radial location <span class="math notranslate nohighlight">\(r\)</span> to <span class="math notranslate nohighlight">\(r + \Delta r\)</span>.
The parcel is stable to convection if the displaced parcel’s density is
greater than
the surrounding fluid and gravity pushes the parcel back towards where it came
from. Then the criterion for stability should be</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-6">
<span class="eqno">(336)<a class="headerlink" href="#equation-thermo-notes-6" title="Link to this equation"></a></span>\[\begin{split}\begin{aligned}
 \rho_{parcel}(r+\Delta r) - \rho_{background}(r + \Delta r) &amp;&gt;&amp; 0 \\
 \bigg[\rho_{parcel}(r) + \bigg(\frac{d\rho}{dr}\bigg)_{parcel}\Delta r\bigg] -
 \bigg[\rho_{background}(r) + \bigg(\frac{d\rho}{dr}\bigg)_{background}\Delta r\bigg] &amp;&gt;&amp; 0 \end{aligned}\end{split}\]</div>
<p>Since the parcel originates at r, <span class="math notranslate nohighlight">\(\rho_{parcel}(r) = \rho_{background}(r)\)</span> and
so the stability criterion is</p>
<div class="math notranslate nohighlight" id="equation-eqn-basicstability">
<span class="eqno">(337)<a class="headerlink" href="#equation-eqn-basicstability" title="Link to this equation"></a></span>\[\bigg(\frac{d\rho}{dr}\bigg)_{parcel} &gt; \bigg(\frac{d\rho}{dr}\bigg)_{background}\]</div>
<p>Since the total pressure, <span class="math notranslate nohighlight">\(P\)</span>, always increases inward in a star in hydrostatic
equilibrium, we can use <span class="math notranslate nohighlight">\(P\)</span> instead of <span class="math notranslate nohighlight">\(r\)</span> as the independent radial variable.
Then condition for stability can be written as</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-7">
<span class="eqno">(338)<a class="headerlink" href="#equation-thermo-notes-7" title="Link to this equation"></a></span>\[\bigg( \frac{d \ln \rho}{d \ln P}\bigg )_{parcel} &lt; \bigg(\frac{d \ln \rho}{d \ln P}\bigg)_{background}\]</div>
<p>Using the equation of state <span class="math notranslate nohighlight">\(P = P( \rho, T, \bar{\mu})\)</span>, where
<span class="math notranslate nohighlight">\(\bar{\mu}\)</span> is the average mass per molecule, we can write</p>
<div class="math notranslate nohighlight" id="equation-eqn-lneos">
<span class="eqno">(339)<a class="headerlink" href="#equation-eqn-lneos" title="Link to this equation"></a></span>\[d \ln P = \frac{\partial \ln P}{\partial \ln \rho} \bigg |_{T, \bar{\mu}}d \ln \rho + \frac{\partial \ln P}{\partial \ln T} \bigg |_{\rho, \bar{\mu}} d \ln T + \frac{\partial \ln P}{\partial \ln \bar{\mu}}\bigg |_{\rho, T} d \ln \bar{\mu}\\]</div>
<p>For convenience we introduce</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-8">
<span class="eqno">(340)<a class="headerlink" href="#equation-thermo-notes-8" title="Link to this equation"></a></span>\[\chi_{\rho} = \frac{\partial \ln P}{\partial \ln \rho}\bigg |_{T,\bar{\mu}} \qquad
  \chi_T = \frac{\partial \ln P}{\partial \ln T} \bigg |_{\rho,\bar{\mu}} \qquad
  \chi_{\bar{\mu}} = \frac{\partial \ln P}{\partial \ln \bar{\mu}} \bigg |_{\rho, T}\]</div>
<p>Then we can rearrange <a class="reference internal" href="#equation-eqn-lneos">Eq.339</a> to get</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-9">
<span class="eqno">(341)<a class="headerlink" href="#equation-thermo-notes-9" title="Link to this equation"></a></span>\[\frac{d \ln \rho}{\partial \ln P} = \frac{1}{\chi_\rho} -
  \frac{\chi_T}{\chi_\rho} \frac{d \ln T}{d \ln P}- \frac{\chi_{\bar{\mu}}}{\chi_\rho}
  \frac{d \ln \bar{\mu}}{d \ln P}\]</div>
<p>Then the general stability criterion is</p>
<div class="math notranslate nohighlight" id="equation-eqn-genstability">
<span class="eqno">(342)<a class="headerlink" href="#equation-eqn-genstability" title="Link to this equation"></a></span>\[\bigg ( \frac{1}{\chi_\rho} -
  \frac{\chi_T}{\chi_\rho} \frac{d \ln T}{d \ln P}- \frac{\chi_{\bar{\mu}}}{\chi_\rho}
  \frac{d \ln \bar{\mu}}{d \ln P} \bigg )_{parcel} &lt;
  \bigg ( \frac{1}{\chi_\rho} -
  \frac{\chi_T}{\chi_\rho} \frac{d \ln T}{d \ln P}- \frac{\chi_{\bar{\mu}}}{\chi_\rho}
  \frac{d \ln \bar{\mu}}{d \ln P} \bigg )_{background}\]</div>
<p>Here’s where various assumptions/simplifications get used.</p>
<ol class="arabic">
<li><p>If no assumptions are made, you can’t get any further than
<a class="reference internal" href="#equation-eqn-genstability">Eq.342</a>. Even in view of an infinitesimally small
initial perturbation, you can’t, in general, assume the
<span class="math notranslate nohighlight">\(\chi\)</span>’s in parcel are the same as the <span class="math notranslate nohighlight">\(\chi\)</span>’s in
the background.  This applies in the case where nuclear reactions
and/or ionization change the composition of the parcel. This case
tends not to be of much interest for two reasons. Either
composition effects get incorporated implicitly through assuming
chemical equilibrium. Or both of these terms can be neglected in
the rising parcel. This would be justified if the timescale for
reactions is long compared to the convective timescale, and either
the same is true for ionization or the fluid is fully ionized.</p></li>
<li><p>If we assume that <span class="math notranslate nohighlight">\(\bar{\mu}\)</span> remains constant in the parcel, then
<span class="math notranslate nohighlight">\(\frac{d \ln \bar{\mu}}{d \ln P}\)</span> drops out for the parcel. In this case,
we can assume, in view of the arbitrarily small initial perturbation of
the parcel, that <span class="math notranslate nohighlight">\(\chi_\rho\)</span> and <span class="math notranslate nohighlight">\(\chi_T\)</span> to have the same values in the
parcel as in the background. Then the stability criterion becomes</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-10">
<span class="eqno">(343)<a class="headerlink" href="#equation-thermo-notes-10" title="Link to this equation"></a></span>\[\bigg (  \frac{d \ln T}{d \ln P} \bigg )_{parcel} &gt;
  \bigg (  \frac{d \ln T}{d \ln P} + \frac{\chi_{\bar{\mu}}}{\chi_T}
  \frac{d \ln \bar{\mu}}{d \ln P} \bigg )_{background}
\label{eqn:Ledoux}\]</div>
<p>The Ledoux stability criterion is obtained by assuming that the parcel moves
adiabatically.</p>
</li>
<li><p>If we assume
that the background is in chemical equilibrium and the parcel achieves
instantaneous chemical equilibrium, then <span class="math notranslate nohighlight">\(\bar{\mu} = \bar{\mu}(\rho,T)\)</span> for
the background and the parcel. (Note that we aren’t requiring constant
composition in the parcel here.)
The effect of variable composition are then absorbed into <span class="math notranslate nohighlight">\(\chi_\rho\)</span> and
<span class="math notranslate nohighlight">\(\chi_T\)</span>. Again, we can take <span class="math notranslate nohighlight">\(\chi_\rho\)</span> and <span class="math notranslate nohighlight">\(\chi_T\)</span> to have the same values
in the parcel as in the background. The criterion then is</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-11">
<span class="eqno">(344)<a class="headerlink" href="#equation-thermo-notes-11" title="Link to this equation"></a></span>\[\bigg ( \frac{d \ln T}{d \ln P} \bigg )_{parcel} &gt;
  \bigg ( \frac{d \ln T}{d \ln P} \bigg )_{background}
\label{eqn:Schwarz}\]</div>
<p>We obtain the Schwarzchild criterion for
stability if we also assume the parcel moves adiabatically.</p>
<p>The Scharwzchild criterion can be recast in terms of entropy if
the EOS is taken as <span class="math notranslate nohighlight">\(P(\rho, S)\)</span> instead of <span class="math notranslate nohighlight">\(P(\rho, T)\)</span>. Then, in place
of <a class="reference internal" href="#equation-eqn-lneos">Eq.339</a> we have</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-12">
<span class="eqno">(345)<a class="headerlink" href="#equation-thermo-notes-12" title="Link to this equation"></a></span>\[d \rho = \frac{\partial \rho}{\partial P} \bigg |_{S} d P + \frac{\partial \rho}{\partial S} \bigg |_{P} dS\]</div>
<p>We can substitute this into <a class="reference internal" href="#equation-eqn-basicstability">Eq.337</a> for stability,
and assuming the parcel moves adiabatically, we get</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-13">
<span class="eqno">(346)<a class="headerlink" href="#equation-thermo-notes-13" title="Link to this equation"></a></span>\[\bigg ( \frac{\partial \rho}{\partial S} \bigg |_{P} \frac{dS}{dr}
  \bigg )_{background}&lt; 0\]</div>
<p>One of Maxwell’s relations is</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-14">
<span class="eqno">(347)<a class="headerlink" href="#equation-thermo-notes-14" title="Link to this equation"></a></span>\[\frac{\partial \rho^{-1}}{\partial S} \bigg |_{P} = \frac{\partial T}{\partial P} \bigg |_{S}\]</div>
<p>All thermodynamically stable substances have temperatures that increase upon
adiabatic compression, i.e. <span class="math notranslate nohighlight">\(\frac{\partial T}{\partial P} \big |_{S} &gt; 0\)</span>.
So Maxwell’s relation implies that
<span class="math notranslate nohighlight">\(\frac{\partial \rho}{\partial S} \big |_{P} &lt; 0\)</span>.
The stability criterion then becomes</p>
<div class="math notranslate nohighlight" id="equation-eqn-stabilityentr">
<span class="eqno">(348)<a class="headerlink" href="#equation-eqn-stabilityentr" title="Link to this equation"></a></span>\[\bigg ( \frac{d S}{d r} \bigg )_{background} &gt; 0\]</div>
</li>
</ol>
<p>Determining which stability criterion we want to enforce in creating the
initial model is complicated by the phenomenon of semiconvection, which
occurs when the Ledoux criterion is satisfied but the Schwarzchild is not,
i.e.</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-15">
<span class="eqno">(349)<a class="headerlink" href="#equation-thermo-notes-15" title="Link to this equation"></a></span>\[\bigg (  \frac{d \ln T}{d \ln P} \bigg )_{parcel} &lt;
  \bigg (  \frac{d \ln T}{d \ln P} \bigg )_{background} &lt;
  \bigg (  \frac{d \ln T}{d \ln P} \bigg )_{parcel} -
  \bigg ( \frac{\chi_{\bar{\mu}}}{\chi_T}
  \frac{d \ln \bar{\mu}}{d \ln P} \bigg )_{background}\]</div>
<p>(Note that <span class="math notranslate nohighlight">\(\chi_{\bar{\mu}}\)</span> is negative, as pressure is inversely proportional
to mass per particle, and <span class="math notranslate nohighlight">\(\frac{d \ln \bar{\mu}}{d \ln P}\)</span> is positive, since
nuclear reactions synthesize more massive particles in the center of the star.)
In this case, when a rising parcel eventually reaches neutral buoyancy, it will
have a temperature excess in comparison to it’s surroundings.
If the parcel can retain
it’s identity against diffusive mixing with the background long enough for
significant heat exchange to occur, then the parcel’s temperature will drop, it
will contract increasing it’s density, and the parcel will move inwards.
The time scale of semiconvection is much longer than the timescale of
traditional convection.</p>
<p>When we set up an initial model, we want to minimize any initial tendency
towards convective motions, as we want these to be driven by the heating due
to nuclear reactions,
not the initial configuration we supply. Thus I think we want to guard against
semiconvection as well as “traditional” convection by using the stability
criterion</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-16">
<span class="eqno">(350)<a class="headerlink" href="#equation-thermo-notes-16" title="Link to this equation"></a></span>\[\bigg ( \frac{d \ln T}{d \ln P} \bigg )_{parcel} =
\frac{d \ln T}{d \ln P} \bigg |_{S,\bar{\mu}} &gt;
  \bigg ( \frac{d \ln T}{d \ln P} \bigg )_{background}\]</div>
<p>Although this looks like the Schwarschild criterion (and, because I’m not
entirely sure on vocabulary, it might even be called the Schwarzchild
criterion), this does not simplify to <a class="reference internal" href="#equation-eqn-stabilityentr">Eq.348</a>
because we need to keep the explicit <span class="math notranslate nohighlight">\(\bar{\mu}\)</span> dependence in the EOS.</p>
<p>The question of whether we’re in chemical equilibrium or not might be a moot
point since our EOS (or any other part of the code) doesn’t enforce chemical
equilibrium. Thus, even
in the case of chemical equilbrium, we can’t in general
drop the explicit <span class="math notranslate nohighlight">\(\bar{\mu}\)</span>
dependence from our equations. If we wanted to do that, then we would need
<span class="math notranslate nohighlight">\(\bar{\mu}(\rho,T)\)</span> to be substituted for <span class="math notranslate nohighlight">\(\bar{\mu}\)</span> inside the EOS.</p>
</section>
<section id="adiabatic-excess">
<span id="sec-adiabatic-excess"></span><h2>Adiabatic Excess<a class="headerlink" href="#adiabatic-excess" title="Link to this heading"></a></h2>
<p>The adiabatic excess, <span class="math notranslate nohighlight">\(\Delta\nabla\)</span>, is a quantity used to determine
if a system is stable (<span class="math notranslate nohighlight">\(\Delta\nabla &lt; 0\)</span>) or unstable (<span class="math notranslate nohighlight">\(\Delta\nabla
&gt; 0\)</span>) to convection under the Schwarzschild criterion (i.e. neglecting
compositional gradients). Cox and Giuli (see chapter 9) define three
different “adiabatic exponents” that we will use:</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-17">
<span class="eqno">(351)<a class="headerlink" href="#equation-thermo-notes-17" title="Link to this equation"></a></span>\[\begin{split}\begin{aligned}
  \Gamma_1 &amp;\equiv&amp;   \left(\frac{d\ln p}{d\ln\rho}\right)_\text{ad} \\
  \frac{\Gamma_2}{\Gamma_2-1} &amp;\equiv&amp;
  \left(\frac{d\ln p}{d\ln T}\right)_\text{ad} \\
  \Gamma_3 - 1 &amp;\equiv&amp; \left(\frac{d\ln T}{d\ln\rho}\right)_\text{ad},\end{aligned}\end{split}\]</div>
<p>where the subscript “ad” means along an adiabat. We can combine the
exponents to get the following relation</p>
<div class="math notranslate nohighlight" id="equation-eq-gamma-relations">
<span class="eqno">(352)<a class="headerlink" href="#equation-eq-gamma-relations" title="Link to this equation"></a></span>\[\Gamma_1 = \left(\frac{\Gamma_2}{\Gamma_2-1}\right)\left(\Gamma_3-1\right).\]</div>
<p>The adiabatic excess is defined as</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-18">
<span class="eqno">(353)<a class="headerlink" href="#equation-thermo-notes-18" title="Link to this equation"></a></span>\[\label{eq:adiabatic excess}
  \Delta\nabla = \nabla_\text{actual} - \nabla_\text{ad}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-19">
<span class="eqno">(354)<a class="headerlink" href="#equation-thermo-notes-19" title="Link to this equation"></a></span>\[\label{eq:thermal gradient}
  \nabla \equiv \frac{d\ln T}{d\ln P}\]</div>
<p>is the thermal gradient. It is important to note that these thermal
gradients are only along the radial direction. The “actual”
gradient can be found from finite differencing the data whereas the
adiabatic term, <span class="math notranslate nohighlight">\(\nabla_\text{ad} = \left(\Gamma_2-1\right) /
\Gamma_2\)</span>, will need to be calculated at each point using
thermodynamic relations. Our EOS only returns <span class="math notranslate nohighlight">\(\Gamma_1\)</span> so we need
find another relation to use with <a class="reference internal" href="#equation-eq-gamma-relations">Eq.352</a> to solve
for the adiabatic excess.</p>
<p>The Schwarzschild criterion does not care about changes in composition
and we therefore write <span class="math notranslate nohighlight">\(p = p(\rho,T)\)</span> and</p>
<div class="math notranslate nohighlight" id="equation-eq-dp">
<span class="eqno">(355)<a class="headerlink" href="#equation-eq-dp" title="Link to this equation"></a></span>\[d\ln p = \chi_\rho d\ln\rho + \chi_T d\ln T\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-20">
<span class="eqno">(356)<a class="headerlink" href="#equation-thermo-notes-20" title="Link to this equation"></a></span>\[\chi_\rho = \left(\frac{d\ln p}{d\ln\rho}\right)_T,\qquad
\chi_T = \left(\frac{d\ln p}{d\ln T}\right)_\rho.\]</div>
<p>Dividing <a class="reference internal" href="#equation-eq-dp">Eq.355</a> by <span class="math notranslate nohighlight">\(d\ln\rho\)</span> and taking this along an adiabat
we have</p>
<div class="math notranslate nohighlight" id="equation-eq-dp2">
<span class="eqno">(357)<a class="headerlink" href="#equation-eq-dp2" title="Link to this equation"></a></span>\[\left(\frac{d\ln p}{d\ln\rho}\right)_\text{ad} = \chi_\rho + \chi_T
  \left(\frac{d\ln T}{d\ln\rho}\right)_\text{ad}.\]</div>
<p>Using the <span class="math notranslate nohighlight">\(\Gamma\)</span>’s, we have</p>
<div class="math notranslate nohighlight" id="equation-eq-gamma1-relation-with-gamma2">
<span class="eqno">(358)<a class="headerlink" href="#equation-eq-gamma1-relation-with-gamma2" title="Link to this equation"></a></span>\[\Gamma_1 = \chi_\rho + \chi_T\left(\Gamma_3-1\right).\]</div>
<p>Combining <a class="reference internal" href="#equation-eq-gamma-relations">Eq.352</a> and <a class="reference internal" href="#equation-eq-gamma1-relation-with-gamma2">Eq.358</a>
to eliminate <span class="math notranslate nohighlight">\(\Gamma_3\)</span>, we have:</p>
<div class="math notranslate nohighlight" id="equation-thermo-notes-21">
<span class="eqno">(359)<a class="headerlink" href="#equation-thermo-notes-21" title="Link to this equation"></a></span>\[\label{eq:nabla_ad}
  \nabla_\text{ad} = \frac{\Gamma_1 - \chi_\rho}{\chi_T\Gamma_1}\]</div>
<p>which uses only terms which are easily returned from an EOS call.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="planar_invsq_basestate.html" class="btn btn-neutral float-left" title="Modifications for a \(1/r^2\) Plane-Parallel Basestate" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="beta0.html" class="btn btn-neutral float-right" title="Notes on \(\beta_0\)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2023, MAESTROeX development tem.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  


</body>
</html>