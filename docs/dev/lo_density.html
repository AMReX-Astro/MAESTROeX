<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Low Density Cutoffs &mdash; MAESTROeX  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css?v=10589de1" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "macros": {"rhozero": "{\\rho_0}", "pizero": "{\\pi_0}", "pizeroone": "{\\pi_0^{(1)}}", "pizerotwo": "{\\pi_0^{(2)}}", "gammabar": "{\\overline{\\Gamma}_1}", "ptl": "{\\partial}", "eb": "{{\\bf e}}", "fb": "{{\\bf f}}", "ib": "{{\\bf i}}", "Ub": "{{\\bf U}}", "Vb": "{{\\bf V}}", "xb": "{{\\bf x}}", "ut": "{{\\tilde{u}}}", "vt": "{{\\tilde{v}}}", "wt": "{{\\tilde{w}}}", "Ubt": "{\\widetilde{\\Ub}}", "edge": "{{\\rm EDGE}}", "mac": "{{\\rm MAC}}", "trans": "{{\\rm TRANS}}", "nablab": "{\\mathbf{\\nabla}}", "cdotb": "{\\mathbf{\\cdot}}", "half": "{\\frac{1}{2}}", "myhalf": "{\\frac{1}{2}}", "nph": "{{n + \\myhalf}}", "nmh": "{{n - \\myhalf}}", "Hext": "{{H_{\\rm ext}}}", "Hnuc": "{{H_{\\rm nuc}}}", "kth": "{k_{\\rm th}}", "init": "{\\rm init}", "model": "{\\rm model}", "raw": "{\\rm raw}", "pred": "{{\\rm pred}}", "Sbar": "{\\overline{S}}", "inp": "{\\mathrm{in}}", "initp": "{\\mathrm{init}}", "outp": "{\\mathrm{out}}", "uadv": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvone": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV},\\star}}", "uadvonedag": "{\\Ubt^{\\mathrm{ADV},\\dagger,\\star}}", "uadvtwo": "{\\widetilde{\\mathbf{U}}^{\\mathrm{ADV}}}", "uadvtwodag": "{\\Ubt^{\\mathrm{ADV},\\dagger}}", "uadvsdcstar": "{\\mathbf{U}^{\\mathrm{ADV},\\star}}", "uadvsdcpred": "{\\mathbf{U}^{\\mathrm{ADV},\\mathrm{pred}}}", "uadvsdc": "{\\mathbf{U}^{\\mathrm{ADV}}}", "dt": "{\\Delta t}", "dr": "{\\Delta r}", "etarho": "{\\eta_{\\rho}}", "etarhoec": "{\\etarho^{\\rm ec}}", "etarhocc": "{\\etarho^{\\rm cc}}", "etarhoflux": "{\\etarho^{\\rm flux}}", "divetarho": "{\\nabla\\cdot(\\etarho\\eb_r)}", "ow": "{\\overline{w}_0}", "dw": "{\\delta w_0}", "thalf": "{\\frac{3}{2}}", "rhop": "{{\\rho^{\\prime}}}", "omegadot": "{\\dot{\\omega}}", "er": "{\\mathbf{e}_r}", "ex": "{\\mathbf{e}_x}", "ey": "{\\mathbf{e}_y}", "ez": "{\\mathbf{e}_z}", "Omegab": "{{\\bf \\Omega}}", "rb": "{{\\bf r}}", "boxtype": "{{\\tt box\\/}}", "fab": "{{\\tt fab\\/}}", "multifab": "{{\\tt multifab\\/}}", "boxarray": "{{\\tt boxarray\\/}}", "mlboxarray": "{{\\tt ml\\_boxarray\\/}}", "layout": "{{\\tt layout\\/}}", "mllayout": "{{\\tt ml\\_layout\\/}}", "bctower": "{{\\tt bc\\_tower\\/}}", "bclevel": "{{\\tt bc\\_level\\/}}", "mgtower": "{{\\tt mg\\_tower\\/}}", "bndryreg": "{{\\tt bndry\\_reg\\/}}", "runparam": ["{\\index{Runtime parameters!{\\tt #1}}{\\tt #1}}", 1], "runparamidx": ["{\\index{Runtime parameters!{\\tt #1}}}", 1], "code": ["{\\index{Code reference!{\\tt #1}}{\\tt #1}}", 1], "codeidx": ["{\\index{Code reference!{\\tt #1}}}", 1], "otherindex": ["{\\index{#1!#2}}", 2], "fdamp": "{{f_\\mathrm{damp}}}"}}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Volume Discrepancy Factor" href="volume_discrepancy.html" />
    <link rel="prev" title="Frequently Asked Questions" href="faq.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >


          
          
          <a href="index.html" class="icon icon-home">
            MAESTROeX
              <img src="_static/maestroex_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
    <div class="branch">
        Branch: <a href="../lo_density.html">main</a> | <a href="./lo_density.html">development</a>
    </div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">MAESTROeX basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to MAESTROeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="flowchart.html">Governing Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="flowchart.html#numerical-methodology">Numerical Methodology</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using MAESTROeX</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="addproblem.html">Adding A New Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="problems.html">Problem Setups</a></li>
<li class="toctree-l1"><a class="reference internal" href="unit_tests.html">Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="param_intro.html">Runtime Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="initial_models.html">Initial Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu.html">GPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="base_state.html">Base State</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="makefiles.html">MAESTROeX Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="managingjobs.html">Managing Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">MAESTROeX technical details</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Low Density Cutoffs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#computing-the-cutoff-values">Computing the Cutoff Values</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#single-level-planar-or-any-spherical">Single-Level Planar or any Spherical</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multilevel-planar">Multilevel Planar</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#when-are-the-cutoff-coordinates-updated">When are the Cutoff Coordinates Updated?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage-of-cutoff-densities">Usage of Cutoff Densities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#anelastic-cutoff-density"><code class="docutils literal notranslate"><span class="pre">anelastic_cutoff_density</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#base-cutoff-density"><code class="docutils literal notranslate"><span class="pre">base_cutoff_density</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#burning-cutoff"><code class="docutils literal notranslate"><span class="pre">burning_cutoff</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#buoyancy-cutoff-factor"><code class="docutils literal notranslate"><span class="pre">buoyancy_cutoff_factor</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="volume_discrepancy.html">Volume Discrepancy Factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="eos_notes.html">Equation of State Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="networks.html">Reaction Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html">The Mixing Term, <span class="math notranslate nohighlight">\(\etarho\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html#eta-flow-chart"><span class="math notranslate nohighlight">\(\eta\)</span> Flow Chart</a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html#computing-etarhoec-and-etarhocc">Computing <span class="math notranslate nohighlight">\(\etarhoec\)</span> and <span class="math notranslate nohighlight">\(\etarhocc\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html#using-etarhoec">Using <span class="math notranslate nohighlight">\(\etarhoec\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="eta.html#using-etarhocc">Using <span class="math notranslate nohighlight">\(\etarhocc\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="pert.html">Interface State Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="Godunov.html">Godunov Interface States</a></li>
<li class="toctree-l1"><a class="reference internal" href="mg.html">Multigrid</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotation.html">Rotation in MAESTROeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="spherical_basestate.html">Modifications for a Spherical Self-Gravitating Star</a></li>
<li class="toctree-l1"><a class="reference internal" href="planar_invsq_basestate.html">Modifications for a <span class="math notranslate nohighlight">\(1/r^2\)</span> Plane-Parallel Basestate</a></li>
<li class="toctree-l1"><a class="reference internal" href="thermo_notes.html">Notes on Thermodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="beta0.html">Notes on <span class="math notranslate nohighlight">\(\beta_0\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="enthalpy.html">Notes on Enthalpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="regtest.html">Regression Testing and Continuous Integration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="filelist.html">File list</a></li>
<li class="toctree-l1"><a class="reference internal" href="classlist.html">Class list</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MAESTROeX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Low Density Cutoffs</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/lo_density.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="low-density-cutoffs">
<h1>Low Density Cutoffs<a class="headerlink" href="#low-density-cutoffs" title="Link to this heading"></a></h1>
<p>These are working notes for the low density parameters in MAESTROeX.
In low density regions, we modify the behavior of the algorithm. Here
is a summary of some parameters, and a brief description of what they
do.</p>
<ul>
<li><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">base_cutoff_density</span></code>, <span class="math notranslate nohighlight">\(\rho_{\rm base}\)</span>, (real):</div>
<div class="line">Essentially controls the lowest density allowed in the simulation and modifies the behavior
of several modules.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">base_cutoff_density_coord(:)</span></code> (integer array):</div>
<div class="line">For each level in the radial base state array, this is the coordinate of the first cell
where <span class="math notranslate nohighlight">\(\rho_0 &lt; \rho_{\rm base}\)</span>. Slightly more complicated for multilevel problems.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">anelastic_cutoff_density</span></code>, <span class="math notranslate nohighlight">\(\rho_{\rm anelastic}\)</span>, (real):</div>
<div class="line">If <span class="math notranslate nohighlight">\(\rho_0 &lt; \rho_{\rm anelastic}\)</span>, we modify the computation of <span class="math notranslate nohighlight">\(\beta_0\)</span> in the
divergence constraint.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">anelastic_cutoff_density_coord(:)</span></code> (integer array):</div>
<div class="line">Anelastic cutoff analogy of <code class="docutils literal notranslate"><span class="pre">base_cutoff_density_coord(:)</span></code>.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">burning_cutoff_density</span></code>, <span class="math notranslate nohighlight">\(\rho_{\rm burning}\)</span>, (real):</div>
<div class="line">If <span class="math notranslate nohighlight">\(\rho &lt; \rho_{\rm burning}\)</span>, don’t call the burner in this cell.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">burning_cutoff_density_coord(:)</span></code> (integer array):</div>
<div class="line">Burning cutoff analogy of <code class="docutils literal notranslate"><span class="pre">base_cutoff_density_coord(:)</span></code>.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">buoyancy_cutoff_factor</span></code> (real):</div>
<div class="line">When computing velocity forcing, set the buoyance term (<span class="math notranslate nohighlight">\(\rho-\rho_0\)</span>) to 0 if
<span class="math notranslate nohighlight">\(\rho &lt; \mathtt{buoyancy\_cutoff\_factor * base\_cutoff\_density}\)</span>.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">do_eos_h_above_cutoff</span></code> (logical):</div>
<div class="line">If true, at the end of the advection step, for each cell where
<span class="math notranslate nohighlight">\(\rho &lt; \rho_{\rm base}\)</span>, recompute <span class="math notranslate nohighlight">\(h = h(\rho,p_0,X)\)</span>.</div>
</div>
</li>
</ul>
<section id="computing-the-cutoff-values">
<h2>Computing the Cutoff Values<a class="headerlink" href="#computing-the-cutoff-values" title="Link to this heading"></a></h2>
<p>We compute <code class="docutils literal notranslate"><span class="pre">anelastic_cutoff_density_coord(:)</span></code>, <code class="docutils literal notranslate"><span class="pre">base_cutoff_density_coord(:)</span></code>,
and <code class="docutils literal notranslate"><span class="pre">burning_cutoff_density_coord(:)</span></code> in analogous fashion.</p>
<section id="single-level-planar-or-any-spherical">
<h3>Single-Level Planar or any Spherical<a class="headerlink" href="#single-level-planar-or-any-spherical" title="Link to this heading"></a></h3>
<p>Here the base state exists as a single one-dimensional array with constant grid
spacing <span class="math notranslate nohighlight">\(\Delta r\)</span>. Basically, we set the corresponding coordinate equal to <span class="math notranslate nohighlight">\(r\)</span> as soon
as <span class="math notranslate nohighlight">\(\rho_0(r)\)</span> is less than or equal to that particular cutoff value.
See the figure below for a graphical representation.</p>
<figure class="align-center" id="id1">
<img alt="_images/cutoff.png" src="_images/cutoff.png" />
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">Image of how the cutoff density and cutoff coordinates
are related for single-level planar and all spherical problems.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Note that for single-level planar or any spherical problem, saying
<span class="math notranslate nohighlight">\(r\ge\)</span> <code class="docutils literal notranslate"><span class="pre">anelastic_cutoff_density_coord</span></code> is analogous to saying
<span class="math notranslate nohighlight">\(\rho_0(r)\le\)</span> <code class="docutils literal notranslate"><span class="pre">anelastic_cutoff_density</span></code>. Also, saying <span class="math notranslate nohighlight">\(r&lt;\)</span>
<code class="docutils literal notranslate"><span class="pre">anelastic_cutoff_density_coord</span></code> is analogous to saying <span class="math notranslate nohighlight">\(\rho_0(r)&gt;\)</span>
<code class="docutils literal notranslate"><span class="pre">anelastic_cutoff_density</span></code>. Ditto for <code class="docutils literal notranslate"><span class="pre">base_cutoff_density</span></code> and
<code class="docutils literal notranslate"><span class="pre">base_cutoff_density_coord</span></code>.</p>
</section>
<section id="multilevel-planar">
<h3>Multilevel Planar<a class="headerlink" href="#multilevel-planar" title="Link to this heading"></a></h3>
<p>In this case, the base state exists as several one-dimensional arrays, each with
different grid spacing. Refer to the figure below in the following examples.
The guiding principle is to check whether <span class="math notranslate nohighlight">\(\rho_0\)</span> falls below <span class="math notranslate nohighlight">\(\rho_{\rm cutoff}\)</span> on the finest
grid first. If not, check the next coarser level. Continue until you reach the base grid.
Some examples are in order:</p>
<figure class="align-center" id="id2">
<img alt="_images/cutoff_multi.png" src="_images/cutoff_multi.png" />
<figcaption>
<p><span class="caption-number">Fig. 17 </span><span class="caption-text">Multilevel cutoff density example.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul>
<li><div class="line-block">
<div class="line"><strong>Example 1:</strong> <span class="math notranslate nohighlight">\(\rho_{0,104} &gt; \rho_{\rm cutoff}\)</span> and <span class="math notranslate nohighlight">\(\rho_{0,105} &lt; \rho_{\rm cutoff}\)</span>.</div>
<div class="line">cutoff_density_coord(1) = 105</div>
<div class="line">cutoff_density_coord(2) = 210</div>
<div class="line">cutoff_density_coord(3) = 420</div>
<div class="line">This is the simplest case in which the cutoff transition happens on the coarsest level.
In this case, the cutoff coordinates at the finer levels are simply propagated from the
coarsest level, even though they do not correspond to a valid region.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><strong>Example 2:</strong> <span class="math notranslate nohighlight">\(\rho_{0,403} &gt; \rho_{\rm cutoff}\)</span> and <span class="math notranslate nohighlight">\(\rho_{0,404} &lt; \rho_{\rm cutoff}\)</span>.</div>
<div class="line">cutoff_density_coord(1) = 101</div>
<div class="line">cutoff_density_coord(2) = 202</div>
<div class="line">cutoff_density_coord(3) = 404</div>
<div class="line">In this case, the cutoff transition happens where the finest grid is present. Happily, the
transition occurs at a location where there is a common grid boundary between all three levels.
Therefore, we simply propagate the cutoff density coordinate from the finest level downward.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><strong>Example 3:</strong> <span class="math notranslate nohighlight">\(\rho_{0,404} &gt; \rho_{\rm cutoff}\)</span> and <span class="math notranslate nohighlight">\(\rho_{0,405} &lt; \rho_{\rm cutoff}\)</span>.</div>
<div class="line">cutoff_density_coord(1) = 102</div>
<div class="line">cutoff_density_coord(2) = 203</div>
<div class="line">cutoff_density_coord(3) = 405</div>
<div class="line">In this case, the cutoff transition happens where the finest grid is present. However, the
transition occurs at a location where there NOT is a common grid boundary between all three
levels. We choose to define the cutoff transition at the coarser levels as being at the
corresponding boundary that is at a larger radius than the location on the finest grid.</div>
</div>
</li>
</ul>
<p>Note: if <span class="math notranslate nohighlight">\(\rho_0\)</span> does not fall below <span class="math notranslate nohighlight">\(\rho_{\rm cutoff}\)</span> at any level, we set the cutoff
coordinate at the fine level to be first first cell above the domain and propagate the
coordinate to the coarser levels.</p>
</section>
</section>
<section id="when-are-the-cutoff-coordinates-updated">
<h2>When are the Cutoff Coordinates Updated?<a class="headerlink" href="#when-are-the-cutoff-coordinates-updated" title="Link to this heading"></a></h2>
<p>At several points in the algorithm, we compute <code class="docutils literal notranslate"><span class="pre">anelastic_cutoff_density_coord(:)</span></code>,
<code class="docutils literal notranslate"><span class="pre">base_cutoff_density_coord(:)</span></code>, and <code class="docutils literal notranslate"><span class="pre">burning_cutoff_density_coord(:)</span></code>:</p>
<ul class="simple">
<li><p>After we call <code class="docutils literal notranslate"><span class="pre">initialize</span></code> in <code class="docutils literal notranslate"><span class="pre">varden</span></code>.</p></li>
<li><p>After reading the base state from a checkpoint file when restarting.</p></li>
<li><p>After regridding.</p></li>
<li><p>After advancing <span class="math notranslate nohighlight">\(\rho_0\)</span> with <code class="docutils literal notranslate"><span class="pre">advect_base_dens</span></code>.</p></li>
<li><p>After advancing <span class="math notranslate nohighlight">\(\rho\)</span> and setting <span class="math notranslate nohighlight">\(\rho_0 = \overline{\rho}\)</span>.</p></li>
<li><p>At the beginning of the second-half of the algorithm (<strong>Step 6</strong>), we reset
the coordinates to the base-time values using <span class="math notranslate nohighlight">\(\rho_0^n\)</span>.</p></li>
</ul>
</section>
<section id="usage-of-cutoff-densities">
<h2>Usage of Cutoff Densities<a class="headerlink" href="#usage-of-cutoff-densities" title="Link to this heading"></a></h2>
<section id="anelastic-cutoff-density">
<span id="index-0"></span><span id="sec-anelastic-cutoff"></span><h3><code class="docutils literal notranslate"><span class="pre">anelastic_cutoff_density</span></code><a class="headerlink" href="#anelastic-cutoff-density" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">anelastic_cutoff_density</span></code> is the density below which we modify the constraint.</p>
<ul class="simple">
<li><p>In probin, <code class="docutils literal notranslate"><span class="pre">anelastic_cutoff_density</span></code> is set to <span class="math notranslate nohighlight">\(-1\)</span> by default.  The user
must supply a value in the inputs file or the code will abort.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">make_div_coeff</span></code>, for
<span class="math notranslate nohighlight">\(r \ge {\tt anelastic\_cutoff\_coord}\)</span>, we set
<span class="math notranslate nohighlight">\({\tt div\_coeff}(n,r) = {\tt div\_coeff}(n,r-1) * \rho_0(n,r)/\rho_0(n,r-1)\)</span>.</p></li>
<li><p>in <code class="docutils literal notranslate"><span class="pre">make_S</span></code>, we set <code class="docutils literal notranslate"><span class="pre">delta_gamma1_term</span></code> and <code class="docutils literal notranslate"><span class="pre">delta_gamma1</span></code>
to zero for <span class="math notranslate nohighlight">\(r \ge {\tt anelastic\_cutoff\_coord}\)</span>. This is only relevant
if you are running with <code class="docutils literal notranslate"><span class="pre">use_delta_gamma1_term</span> <span class="pre">=</span> <span class="pre">T</span></code>.</p></li>
<li><p>Some versions of sponge, use <code class="docutils literal notranslate"><span class="pre">anelastic_cutoff_density</span></code> in a problem dependent way.</p></li>
</ul>
</section>
<section id="base-cutoff-density">
<span id="index-1"></span><span id="sec-base-cutoff-density"></span><h3><code class="docutils literal notranslate"><span class="pre">base_cutoff_density</span></code><a class="headerlink" href="#base-cutoff-density" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">base_cutoff_density</span></code> is the lowest density that we model.</p>
<ul class="simple">
<li><p>In probin, <code class="docutils literal notranslate"><span class="pre">base_cutoff_density</span></code> is set to <span class="math notranslate nohighlight">\(-1\)</span> by default. The user
must supply a value in the inputs file or the code will abort.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">base_state</span></code>, we compute a physical cutoff location,
<code class="docutils literal notranslate"><span class="pre">base_cutoff_density_loc</span></code>, which is defined as the physical
location of the first cell-center at the coarsest level for which
<span class="math notranslate nohighlight">\(\rho_0 \le {\tt base\_cutoff\_density}\)</span>. This is a trick used for making
the data consistent for multiple level problems. When we are generating the
initial background/base state, if we are above <code class="docutils literal notranslate"><span class="pre">base_cutoff_density_loc</span></code>,
just use the values for <span class="math notranslate nohighlight">\(\rho,T\)</span>, and <span class="math notranslate nohighlight">\(p\)</span> at <code class="docutils literal notranslate"><span class="pre">base_cutoff_density_loc</span></code>.
When we check whether we are in HSE, we use <code class="docutils literal notranslate"><span class="pre">base_cutoff_density_loc</span></code>.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">make_S_nodal</span></code>, <code class="docutils literal notranslate"><span class="pre">make_macrhs</span></code>, and <code class="docutils literal notranslate"><span class="pre">make_w0</span></code>,
we only add the volume discrepancy for <span class="math notranslate nohighlight">\(r &lt; {\tt base\_cutoff\_density\_coord}\)</span>
(in plane parallel) and if <span class="math notranslate nohighlight">\(\rho_0^{\rm cart} &gt; {\tt base\_cutoff\_density}\)</span>
(in spherical).</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">mkrhohforce</span></code> for plane-parallel, for
<span class="math notranslate nohighlight">\(r \ge {\tt base\_cutoff\_density\_coord}\)</span>, we
compute <span class="math notranslate nohighlight">\(\nabla p_0\)</span> with a difference stencil instead of simply
setting it to <span class="math notranslate nohighlight">\(\rho_0 g\)</span>.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">update_scal</span></code>, if <span class="math notranslate nohighlight">\(\rho \le {\tt base\_cutoff\_density}\)</span>
and <code class="docutils literal notranslate"><span class="pre">do_eos_h_above_cutoff</span></code>, we call the EOS to compute <span class="math notranslate nohighlight">\(h\)</span>.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">update_scal</span></code>, if <span class="math notranslate nohighlight">\(\rho \le {\tt base\_cutoff\_density}/2\)</span>
we set it to <span class="math notranslate nohighlight">\({\tt base\_cutoff\_density}/2\)</span>.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">make_grav</span></code> for spherical, we only add the enclosed mass if
<span class="math notranslate nohighlight">\(\rho_0 &gt; {\tt base\_cutoff\_density}\)</span>.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">enforce_HSE</span></code>, we set <span class="math notranslate nohighlight">\(p_0(r+1) = p_0(r)\)</span> for
<span class="math notranslate nohighlight">\(r \ge {\tt base\_cutoff\_density\_coord}\)</span>.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">make_psi</span></code> for plane-parallel, we only compute <span class="math notranslate nohighlight">\(\psi\)</span> for
<span class="math notranslate nohighlight">\(r &lt; {\tt base\_cutoff\_density\_coord}\)</span>.</p></li>
</ul>
</section>
<section id="burning-cutoff">
<span id="index-2"></span><h3><code class="docutils literal notranslate"><span class="pre">burning_cutoff</span></code><a class="headerlink" href="#burning-cutoff" title="Link to this heading"></a></h3>
<p>The burning cutoff determines where we call the reaction network to
get the nuclear energy generation rate and composition changes. For
densities below the burning cutoff, we do not call the network.</p>
<ul class="simple">
<li><p>In <code class="docutils literal notranslate"><span class="pre">probin</span></code>, <code class="docutils literal notranslate"><span class="pre">burning_cutoff_density</span></code> is set to
<code class="docutils literal notranslate"><span class="pre">base_cutoff_density</span></code> it no value is supplied.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">react_state</span></code>, we only call the burner if
<span class="math notranslate nohighlight">\(\rho &gt;\)</span> <code class="docutils literal notranslate"><span class="pre">burning_cutoff_density</span></code>.</p></li>
</ul>
</section>
<section id="buoyancy-cutoff-factor">
<span id="index-3"></span><h3><code class="docutils literal notranslate"><span class="pre">buoyancy_cutoff_factor</span></code><a class="headerlink" href="#buoyancy-cutoff-factor" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">buoyancy_cutoff_factor</span></code> is used to zero out the forcing terms
to the velocity equation at low densities.</p>
<ul>
<li><p>In <code class="docutils literal notranslate"><span class="pre">init_base_state</span></code> we print out the value of the
the density at which the buoyancy cutoff would take effect,
<code class="docutils literal notranslate"><span class="pre">buoyancy_cutoff_factor</span></code> * <code class="docutils literal notranslate"><span class="pre">base_cutoff_density</span></code>.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">mk_vel_force</span></code>, we zero out <code class="docutils literal notranslate"><span class="pre">rhopert</span></code>, the
perturbational density used in computing the buoyancy force,
if <span class="math notranslate nohighlight">\(\rho &lt; \mathtt{buoyancy\_cutoff\_factor * base\_cutoff\_density}\)</span>.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">mk_vel_force</span></code>, for spherical problems, we
zero out <code class="docutils literal notranslate"><span class="pre">centrifugal_term</span></code>, the centrifugal force for
rotating stars, if <span class="math notranslate nohighlight">\(\rho &lt; \mathtt{buoyancy\_cutoff\_factor * base\_cutoff\_density}\)</span>.</p></li>
<li><div class="line-block">
<div class="line">In <code class="docutils literal notranslate"><span class="pre">make_explicit_thermal</span></code>, if <code class="docutils literal notranslate"><span class="pre">limit_conductivity</span> <span class="pre">=</span> <span class="pre">T</span></code>, then for
<span class="math notranslate nohighlight">\(\rho &lt; \mathtt{buoyancy\_cutoff\_factor}\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(* \mathtt{base\_cutoff\_density}\)</span>, we
zero out the thermal coefficients, effectively turning off thermal
diffusion there.</div>
</div>
</li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="faq.html" class="btn btn-neutral float-left" title="Frequently Asked Questions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="volume_discrepancy.html" class="btn btn-neutral float-right" title="Volume Discrepancy Factor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2023, MAESTROeX development tem.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  


</body>
</html>